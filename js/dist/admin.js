/*! For license information please see admin.js.LICENSE.txt */
(()=>{var t={24(t,n,e){var a=e(163),i=e(110),s=e(996),r=e(312),l=e(166),o=e(766),c=e(760);function g(){"use strict";var n=i(),e=n.m(g),u=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function m(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))}var d={throw:1,return:2,break:3,continue:3};function h(t){var n,e;return function(a){n||(n={stop:function(){return e(a.a,2)},catch:function(){return a.v},abrupt:function(t,n){return e(a.a,d[t],n)},delegateYield:function(t,i,s){return n.resultName=i,e(a.d,c(t),s)},finish:function(t){return e(a.f,t)}},e=function(t,e,i){a.p=n.prev,a.n=n.next;try{return t(e,i)}finally{n.next=a.n}}),n.resultName&&(n[n.resultName]=a.v,n.resultName=void 0),n.sent=a.v,n.next=a.n;try{return t.call(this,n)}finally{a.p=n.prev,a.n=n.next}}}return(t.exports=g=function(){return{wrap:function(t,e,a,i){return n.w(h(t),e,a,i&&i.reverse())},isGeneratorFunction:m,mark:n.m,awrap:function(t,n){return new a(t,n)},AsyncIterator:l,async:function(t,n,e,a,i){return(m(n)?r:s)(h(t),n,e,a,i)},keys:o,values:c}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=g,t.exports.__esModule=!0,t.exports.default=t.exports},110(t,n,e){var a=e(397);function i(){var n,e,s="function"==typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",l=s.toStringTag||"@@toStringTag";function o(t,i,s,r){var l=i&&i.prototype instanceof g?i:g,o=Object.create(l.prototype);return a(o,"_invoke",function(t,a,i){var s,r,l,o=0,g=i||[],u=!1,m={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(t,e){return s=t,r=0,l=n,m.n=e,c}};function d(t,a){for(r=t,l=a,e=0;!u&&o&&!i&&e<g.length;e++){var i,s=g[e],d=m.p,h=s[2];t>3?(i=h===a)&&(l=s[(r=s[4])?5:(r=3,3)],s[4]=s[5]=n):s[0]<=d&&((i=t<2&&d<s[1])?(r=0,m.v=a,m.n=s[1]):d<h&&(i=t<3||s[0]>a||a>h)&&(s[4]=t,s[5]=a,m.n=h,r=0))}if(i||t>1)return c;throw u=!0,a}return function(i,g,h){if(o>1)throw TypeError("Generator is already running");for(u&&1===g&&d(g,h),r=g,l=h;(e=r<2?n:l)||!u;){s||(r?r<3?(r>1&&(m.n=-1),d(r,l)):m.n=l:m.v=l);try{if(o=2,s){if(r||(i="next"),e=s[i]){if(!(e=e.call(s,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,r<2&&(r=0)}else 1===r&&(e=s.return)&&e.call(s),r<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),r=1);s=n}else if((e=(u=m.n<0)?l:t.call(a,m))!==c)break}catch(t){s=n,r=1,l=t}finally{o=1}}return{value:e,done:u}}}(t,s,r),!0),o}var c={};function g(){}function u(){}function m(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(a(e={},r,function(){return this}),e),h=m.prototype=g.prototype=Object.create(d);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,a(t,l,"GeneratorFunction")),t.prototype=Object.create(h),t}return u.prototype=m,a(h,"constructor",m),a(m,"constructor",u),u.displayName="GeneratorFunction",a(m,l,"GeneratorFunction"),a(h),a(h,l,"Generator"),a(h,r,function(){return this}),a(h,"toString",function(){return"[object Generator]"}),(t.exports=i=function(){return{w:o,m:p}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},163(t){t.exports=function(t,n){this.v=t,this.k=n},t.exports.__esModule=!0,t.exports.default=t.exports},166(t,n,e){var a=e(163),i=e(397);t.exports=function t(n,e){function s(t,i,r,l){try{var o=n[t](i),c=o.value;return c instanceof a?e.resolve(c.v).then(function(t){s("next",t,r,l)},function(t){s("throw",t,r,l)}):e.resolve(c).then(function(t){o.value=t,r(o)},function(t){return s("throw",t,r,l)})}catch(t){l(t)}}var r;this.next||(i(t.prototype),i(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),i(this,"_invoke",function(t,n,a){function i(){return new e(function(n,e){s(t,a,n,e)})}return r=r?r.then(i,i):i()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports},183(t,n,e){var a=e(24)();t.exports=a;try{regeneratorRuntime=a}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}},312(t,n,e){var a=e(110),i=e(166);t.exports=function(t,n,e,s,r){return new i(a().w(t,n,e,s),r||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},397(t){function n(e,a,i,s){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}t.exports=n=function(t,e,a,i){function s(e,a){n(t,e,function(t){return this._invoke(e,a,t)})}e?r?r(t,e,{value:a,enumerable:!i,configurable:!i,writable:!i}):t[e]=a:(s("next",0),s("throw",1),s("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,n(e,a,i,s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},735(t){function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},760(t,n,e){var a=e(735).default;t.exports=function(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(a(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},766(t){t.exports=function(t){var n=Object(t),e=[];for(var a in n)e.unshift(a);return function t(){for(;e.length;)if((a=e.pop())in n)return t.value=a,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},996(t,n,e){var a=e(312);t.exports=function(t,n,e,i,s){var r=a(t,n,e,i,s);return r.next().then(function(t){return t.done?t.value:r.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}},n={};function e(a){var i=n[a];if(void 0!==i)return i.exports;var s=n[a]={exports:{}};return t[a](s,s.exports,e),s.exports}e.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},e.d=(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),(()=>{"use strict";const t=flarum.core.compat["admin/app"];var n=e.n(t);function a(t,n,e,a,i,s,r){try{var l=t[s](r),o=l.value}catch(t){return void e(t)}l.done?n(o):Promise.resolve(o).then(a,i)}function i(t){return function(){var n=this,e=arguments;return new Promise(function(i,s){var r=t.apply(n,e);function l(t){a(r,i,s,l,o,"next",t)}function o(t){a(r,i,s,l,o,"throw",t)}l(void 0)})}}function s(t,n){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},s(t,n)}var r=e(183),l=e.n(r);const o=flarum.core.compat["admin/components/ExtensionPage"];var c=e.n(o);const g=flarum.core.compat["common/components/Button"];var u=e.n(g);const d=flarum.core.compat["common/components/Switch"];var h=e.n(d);const p=flarum.core.compat["common/components/Select"];var f=e.n(p);const k=flarum.core.compat["common/components/LoadingIndicator"];var b=e.n(k),v=function(t){function e(){for(var n,e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return(n=t.call.apply(t,[this].concat(a))||this).loading=!1,n.activeTab="basic",n.logs=[],n.logsLoading=!1,n.logsMeta={},n}var a,r;r=t,(a=e).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r);var o=e.prototype;return o.oninit=function(n){t.prototype.oninit.call(this,n)},o.content=function(){var t=this;return m("div",{className:"DingtalkSettingsPage"},m("div",{className:"DingtalkSettingsPage-header"},m("h2",null,m("i",{className:"fas fa-comment-dots"}),m("span",{className:"DingtalkSettingsPage-title"},n().translator.trans("jiushutech-dingtalk-login.admin.title"))),m("p",{className:"DingtalkSettingsPage-description"},n().translator.trans("jiushutech-dingtalk-login.admin.description"))),m("div",{className:"DingtalkSettingsPage-tabs"},m("button",{className:"DingtalkSettingsPage-tab"+("basic"===this.activeTab?" active":""),onclick:function(){t.activeTab="basic",m.redraw()}},m("i",{className:"fas fa-cog"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.tabs.basic"))),m("button",{className:"DingtalkSettingsPage-tab"+("login"===this.activeTab?" active":""),onclick:function(){t.activeTab="login",m.redraw()}},m("i",{className:"fas fa-sign-in-alt"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.tabs.login"))),m("button",{className:"DingtalkSettingsPage-tab"+("sync"===this.activeTab?" active":""),onclick:function(){t.activeTab="sync",m.redraw()}},m("i",{className:"fas fa-sync"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.tabs.sync"))),m("button",{className:"DingtalkSettingsPage-tab"+("logs"===this.activeTab?" active":""),onclick:function(){t.activeTab="logs",t.loadLogs(),m.redraw()}},m("i",{className:"fas fa-list"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.tabs.logs")))),m("div",{className:"DingtalkSettingsPage-content"},"basic"===this.activeTab&&this.renderBasicSettings(),"login"===this.activeTab&&this.renderLoginSettings(),"sync"===this.activeTab&&this.renderSyncSettings(),"logs"===this.activeTab&&this.renderLogsTab()))},o.renderBasicSettings=function(){return m("div",{className:"DingtalkSettingsPage-section"},m("div",{className:"DingtalkSettingsPage-sectionHeader"},m("h3",null,m("i",{className:"fas fa-key"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.basic.api_config"))),m("p",{className:"DingtalkSettingsPage-sectionHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.api_config_help"))),m("div",{className:"DingtalkSettingsPage-formGrid"},m("div",{className:"Form-group"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.app_key")),m("input",{className:"FormControl",type:"text",bidi:this.setting("jiushutech-dingtalk-login.app_key"),placeholder:String(n().translator.trans("jiushutech-dingtalk-login.admin.basic.app_key_placeholder"))})),m("div",{className:"Form-group"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.app_secret")),m("input",{className:"FormControl",type:"password",bidi:this.setting("jiushutech-dingtalk-login.app_secret"),placeholder:String(n().translator.trans("jiushutech-dingtalk-login.admin.basic.app_secret_placeholder"))})),m("div",{className:"Form-group"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.agent_id")),m("input",{className:"FormControl",type:"text",bidi:this.setting("jiushutech-dingtalk-login.agent_id"),placeholder:String(n().translator.trans("jiushutech-dingtalk-login.admin.basic.agent_id_placeholder"))}),m("p",{className:"DingtalkSettingsPage-fieldHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.agent_id_help"))),m("div",{className:"Form-group"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.corp_id")),m("input",{className:"FormControl",type:"text",bidi:this.setting("jiushutech-dingtalk-login.corp_id"),placeholder:String(n().translator.trans("jiushutech-dingtalk-login.admin.basic.corp_id_placeholder"))}),m("p",{className:"DingtalkSettingsPage-fieldHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.corp_id_help"))),m("div",{className:"Form-group"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.callback_url")),m("input",{className:"FormControl",type:"text",bidi:this.setting("jiushutech-dingtalk-login.callback_url"),placeholder:String(n().translator.trans("jiushutech-dingtalk-login.admin.basic.callback_url_placeholder"))}),m("p",{className:"DingtalkSettingsPage-fieldHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.basic.callback_url_help")))),this.submitButton())},o.renderLoginSettings=function(){var t=this;return m("div",{className:"DingtalkSettingsPage-section"},m("div",{className:"DingtalkSettingsPage-sectionHeader"},m("h3",null,m("i",{className:"fas fa-shield-alt"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.login.control")))),m("div",{className:"DingtalkSettingsPage-switchGroup"},m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"0"!==this.setting("jiushutech-dingtalk-login.show_login_button")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.show_login_button")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.login.show_login_button"))),m("p",{className:"DingtalkSettingsPage-switchHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.show_login_button_help"))),m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.force_bind")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.force_bind")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.login.force_bind"))),m("p",{className:"DingtalkSettingsPage-switchHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.force_bind_help"))),m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.only_dingtalk_login")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.only_dingtalk_login")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.login.only_dingtalk"))),m("p",{className:"DingtalkSettingsPage-switchHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.only_dingtalk_help"))),m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.auto_register")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.auto_register")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.login.auto_register"))),m("p",{className:"DingtalkSettingsPage-switchHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.auto_register_help")))),m("div",{className:"DingtalkSettingsPage-formGrid"},m("div",{className:"Form-group"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.login.exempt_users")),m("input",{className:"FormControl",type:"text",bidi:this.setting("jiushutech-dingtalk-login.exempt_users"),placeholder:String(n().translator.trans("jiushutech-dingtalk-login.admin.login.exempt_users_placeholder"))}),m("p",{className:"DingtalkSettingsPage-fieldHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.exempt_users_help")))),m("div",{className:"DingtalkSettingsPage-switchGroup"},m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.enable_h5_login")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.enable_h5_login")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.login.enable_h5"))),m("p",{className:"DingtalkSettingsPage-switchHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.enable_h5_help"))),m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.show_on_index")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.show_on_index")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.login.show_on_index"))),m("p",{className:"DingtalkSettingsPage-switchHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.show_on_index_help"))),m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"0"!==this.setting("jiushutech-dingtalk-login.show_bind_stats")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.show_bind_stats")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.login.show_bind_stats"))),m("p",{className:"DingtalkSettingsPage-switchHelp"},n().translator.trans("jiushutech-dingtalk-login.admin.login.show_bind_stats_help")))),this.submitButton())},o.renderSyncSettings=function(){var t=this;return m("div",{className:"DingtalkSettingsPage-section"},m("div",{className:"DingtalkSettingsPage-sectionHeader"},m("h3",null,m("i",{className:"fas fa-user-cog"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.sync.title")))),m("div",{className:"DingtalkSettingsPage-switchGroup"},m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.sync_nickname")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.sync_nickname")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.sync.nickname")))),m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.sync_avatar")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.sync_avatar")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.sync.avatar"))))),m("div",{className:"Form-group DingtalkSettingsPage-selectGroup"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.sync.username_rule")),m("div",{className:"DingtalkSettingsPage-selectWrapper"},m(f(),{value:this.setting("jiushutech-dingtalk-login.username_rule")()||"nickname",options:{nickname:n().translator.trans("jiushutech-dingtalk-login.admin.sync.username_rule_nickname"),random:n().translator.trans("jiushutech-dingtalk-login.admin.sync.username_rule_random")},onchange:function(n){return t.setting("jiushutech-dingtalk-login.username_rule")(n)}}))),this.submitButton())},o.renderLogsTab=function(){var t=this;return m("div",{className:"DingtalkSettingsPage-section DingtalkSettingsPage-logs"},m("div",{className:"DingtalkSettingsPage-sectionHeader"},m("h3",null,m("i",{className:"fas fa-cog"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.sync.log_settings")))),m("div",{className:"DingtalkSettingsPage-formGrid"},m("div",{className:"Form-group"},m("label",{className:"DingtalkSettingsPage-label"},n().translator.trans("jiushutech-dingtalk-login.admin.sync.log_retention_days")),m("input",{className:"FormControl",type:"number",min:"1",max:"365",bidi:this.setting("jiushutech-dingtalk-login.log_retention_days"),placeholder:String(n().translator.trans("jiushutech-dingtalk-login.admin.sync.log_retention_days_placeholder"))}))),m("div",{className:"DingtalkSettingsPage-switchGroup"},m("div",{className:"DingtalkSettingsPage-switchItem"},m(h(),{state:"1"===this.setting("jiushutech-dingtalk-login.allow_log_export")(),onchange:function(n){return t.setting("jiushutech-dingtalk-login.allow_log_export")(n?"1":"0")}},m("span",{className:"DingtalkSettingsPage-switchLabel"},n().translator.trans("jiushutech-dingtalk-login.admin.sync.allow_log_export"))))),this.submitButton(),m("div",{className:"DingtalkSettingsPage-sectionHeader",style:{marginTop:"30px"}},m("h3",null,m("i",{className:"fas fa-list-alt"}),m("span",null,n().translator.trans("jiushutech-dingtalk-login.admin.logs.title")))),m("div",{className:"DingtalkSettingsPage-logsToolbar"},m(u(),{className:"Button Button--primary",icon:"fas fa-sync",onclick:function(){return t.loadLogs()},loading:this.logsLoading},n().translator.trans("jiushutech-dingtalk-login.admin.logs.refresh")),m(u(),{className:"Button",icon:"fas fa-download",onclick:function(){return t.exportLogs()}},n().translator.trans("jiushutech-dingtalk-login.admin.logs.export"))),this.logsLoading?m("div",{className:"DingtalkSettingsPage-logsLoading"},m(b(),null)):m("div",{className:"DingtalkSettingsPage-logsTable"},m("table",{className:"Table"},m("thead",null,m("tr",null,m("th",null,n().translator.trans("jiushutech-dingtalk-login.admin.logs.time")),m("th",null,n().translator.trans("jiushutech-dingtalk-login.admin.logs.user")),m("th",null,n().translator.trans("jiushutech-dingtalk-login.admin.logs.type")),m("th",null,n().translator.trans("jiushutech-dingtalk-login.admin.logs.status")),m("th",null,n().translator.trans("jiushutech-dingtalk-login.admin.logs.ip")))),m("tbody",null,0===this.logs.length?m("tr",null,m("td",{colspan:"5",className:"DingtalkSettingsPage-logsEmpty"},n().translator.trans("jiushutech-dingtalk-login.admin.logs.empty"))):this.logs.map(function(e){return m("tr",{key:e.id},m("td",null,new Date(e.createdAt).toLocaleString()),m("td",null,e.username||"-"),m("td",null,m("span",{className:"DingtalkSettingsPage-logType DingtalkSettingsPage-logType--"+e.loginType},t.getLoginTypeLabel(e.loginType))),m("td",null,m("span",{className:"DingtalkSettingsPage-logStatus DingtalkSettingsPage-logStatus--"+e.status},"success"===e.status?n().translator.trans("jiushutech-dingtalk-login.admin.logs.status_success"):n().translator.trans("jiushutech-dingtalk-login.admin.logs.status_failed"))),m("td",null,e.loginIp))})))))},o.getLoginTypeLabel=function(t){return{scan:String(n().translator.trans("jiushutech-dingtalk-login.admin.logs.type_scan")),h5:String(n().translator.trans("jiushutech-dingtalk-login.admin.logs.type_h5")),redirect:String(n().translator.trans("jiushutech-dingtalk-login.admin.logs.type_redirect"))}[t]||t},o.loadLogs=function(){var t=i(l().mark(function t(){var e,a;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.logsLoading=!0,m.redraw(),t.prev=1,t.next=2,n().request({method:"GET",url:n().forum.attribute("apiUrl")+"/dingtalk/login-logs"});case 2:e=t.sent,this.logs=e.data||[],this.logsMeta=e.meta||{},t.next=4;break;case 3:t.prev=3,a=t.catch(1),console.error("Failed to load logs:",a),this.logs=[];case 4:return t.prev=4,this.logsLoading=!1,m.redraw(),t.finish(4);case 5:case"end":return t.stop()}},t,this,[[1,3,4,5]])}));return function(){return t.apply(this,arguments)}}(),o.exportLogs=function(){var t=i(l().mark(function t(){var e,a,i,s,r;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,fetch(n().forum.attribute("apiUrl")+"/dingtalk/logs-export",{method:"GET",headers:{Authorization:"Token "+n().session.csrfToken},credentials:"include"});case 1:if((e=t.sent).ok){t.next=2;break}throw new Error("Export failed");case 2:return t.next=3,e.blob();case 3:a=t.sent,i=window.URL.createObjectURL(a),(s=document.createElement("a")).href=i,s.download="dingtalk-login-logs-"+(new Date).toISOString().split("T")[0]+".csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(i),t.next=5;break;case 4:t.prev=4,r=t.catch(0),console.error("Failed to export logs:",r),n().alerts.show({type:"error"},n().translator.trans("jiushutech-dingtalk-login.admin.logs.export_failed"));case 5:case"end":return t.stop()}},t,null,[[0,4]])}));return function(){return t.apply(this,arguments)}}(),e}(c());const _=flarum.core.compat["common/extend"],y=flarum.core.compat["admin/components/UserListPage"];var S=e.n(y),j=null,x=!1,N=!1;function w(){return"0"!==n().data.settings["jiushutech-dingtalk-login.show_bind_stats"]}function P(){return(P=i(l().mark(function t(){var e,a;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!x){t.next=1;break}return t.abrupt("return",j);case 1:return x=!0,t.prev=2,t.next=3,n().request({method:"GET",url:n().forum.attribute("apiUrl")+"/dingtalk/bind-stats"});case 3:return e=t.sent,j=e.data,D(),t.abrupt("return",j);case 4:return t.prev=4,a=t.catch(2),console.error("Failed to load dingtalk stats:",a),t.abrupt("return",null);case 5:return t.prev=5,x=!1,t.finish(5);case 6:case"end":return t.stop()}},t,null,[[2,4,5,6]])}))).apply(this,arguments)}function D(){var t;if(j&&!N&&w()){var e=document.querySelector(".UserListPage-grid");if(e)if(document.querySelector(".DingtalkBindStats"))N=!0;else if(e.querySelector(".UserListPage-grid-header")){var a=document.createElement("div");a.className="DingtalkBindStats",a.innerHTML='\n    <span class="DingtalkBindStats-icon"><i class="fas fa-comment-dots"></i></span>\n    <span class="DingtalkBindStats-label">'+n().translator.trans("jiushutech-dingtalk-login.admin.users.bind_progress")+'</span>\n    <span class="DingtalkBindStats-value">'+j.boundUsers+"/"+j.totalUsers+'</span>\n    <span class="DingtalkBindStats-percentage">'+j.percentage+"%</span>\n  ",null==(t=e.parentNode)||t.insertBefore(a,e),N=!0}}}n().initializers.add("jiushutech-dingtalk-login",function(){n().extensionData.for("jiushutech-dingtalk-login").registerPage(v),(0,_.extend)(S().prototype,"oncreate",function(){N=!1,w()&&(j||x?j&&setTimeout(function(){return D()},100):function(){P.apply(this,arguments)}())}),(0,_.extend)(S().prototype,"onupdate",function(){w()&&j&&!N&&D()}),(0,_.extend)(S().prototype,"columns",function(t){w()&&t.add("dingtalkBound",{name:n().translator.trans("jiushutech-dingtalk-login.admin.users.dingtalk_column"),content:function(t){return t.attribute("dingtalkBound")?m("span",{className:"DingtalkBoundIcon DingtalkBoundIcon--bound",title:String(n().translator.trans("jiushutech-dingtalk-login.admin.users.bound"))},m("svg",{className:"DingtalkLogo",viewBox:"0 0 1024 1024",width:"20",height:"20"},m("path",{fill:"#3296FA",d:"M512 2C230.2 2 2 230.2 2 512s228.2 510 510 510 510-228.2 510-510S793.3 2 512 2z m235.9 442c-1 4.6-3.6 10.8-7.2 19.1l-0.5 0.5c-21.6 45.8-77.3 135.5-77.3 135.5l-0.5-0.5-16.5 28.3h78.8L574.3 826.8l34-136h-61.8l21.6-90.2c-17.5 4.1-38.1 9.8-62.3 18 0 0-33 19.1-94.8-37.1 0 0-41.7-37.1-17.5-45.8 10.3-4.1 50-8.8 81.4-12.9 42.2-5.7 68.5-8.8 68.5-8.8s-130.3 2.1-161.2-3.1c-30.9-4.6-70.1-56.7-78.3-102 0 0-12.9-24.7 27.8-12.9 40.2 11.8 209.2 45.8 209.2 45.8S321.4 375 307 358.5c-14.4-16.5-42.8-89.6-39.2-134.5 0 0 1.5-11.3 12.9-8.2 0 0 161.8 74.2 272.5 114.4C664.5 371.4 760.8 392 747.9 444z"}))):m("span",{className:"DingtalkBoundIcon DingtalkBoundIcon--unbound"})}},45)})})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map